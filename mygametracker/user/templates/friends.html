{% extends 'base.html' %}
{% block title %}Friends{% endblock %}
{% block content %}

{% if request.session.curr_user != '' %}

<h1>{{ request.session.curr_user }}'s Friends</h1>

    <br>

    <div class="card-body p-0">
        <table class="table table-dark table-hover table-borderless table-responsive my-1">
            <thead class="border-bottom">
            <tr>
                <th class="text-center">Friend Name</th>
                <th class="text-center">Date Added</th>
            </tr>
            </thead>
            <tbody>
            {% for friend in friends %}
            <tr class="position-relative align-middle">
                <td class="fs-5 text-center">{{ friend.friend_username }}</td>
                <td class="text-center">{{ friend.date_added }}</td>
                {% endfor %}
            </tbody>
        </table>

            <!-- Remove Friend modal -->
            <form method="post" action="{% url 'user:friends' %}">
                {% csrf_token %}
                <div class="modal fade" id="unfriendModal{{ friend.id }}">
                    <div class="modal-dialog">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h3>Remove Friend</h3>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <input type="text" name="friend_username" class="form-control" placeholder="Enter the username of friend... (e.g. OsamaBin911)" required>
                            </div>
                            <div class="modal-footer">
                                <input type="submit" class="btn btn-success" name="btnConfirm" value="Confirm">
                                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>

            <!-- Add Friend Modal -->
            <form method="post" action="{% url 'user:add_friend' %}">
                {% csrf_token %}
                <div class="modal fade" id="addFriend">
                    <div class="modal-dialog">
                        <div class="modal-content bg-dark">
                            <div class="modal-header">
                                <h4>Add New Friend</h4>
                                <button type="button" class="btn-close btn-close-white"
                                        data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <input type="text" name="friend_username" class="form-control" placeholder="Enter the username of friend... (e.g. OsamaBin911)" required>
                            </div>
                            <div class="modal-footer">
                                <input type="submit" class="btn btn-success" name="btnAddFriend" value="Add">
                                <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>
            </form>
    </div>

<br>

    <div style="display: flex; justify-content: center;">
        <button type="button" class="btn btn-primary mt-2 mx-2" data-bs-toggle="modal" data-bs-target="#addFriend">Add New Friend</button>
        <button type="button" class="btn btn-danger mt-2 mx-2" data-bs-toggle="modal" data-bs-target="#unfriendModal">Unfriend</button>
    </div>

  </div>
<!--<div class="card bg-dark text-light border-light mt-3">-->
<!--  <div class="card-body">This page should contain a list of the user's friend. The user should be able to add and remove friends as well as visit their profile upon clicking.</div>-->
<!--</div>-->

{% else %}

<div class="alert alert-dismissible fade show border border-light">
  <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  <strong>Info!</strong> You are currently not logged in.
</div>
<h1>Friends</h1>
<div class="card bg-dark text-light border-light mt-3">
  <div class="card-body">This page should contain a list of the user's friend. The user should be able to add and remove friends as well as visit their profile upon clicking.</div>
</div>

{% endif %}

{% endblock %}
